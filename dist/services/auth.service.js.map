{"version":3,"file":"auth.service.js","sourceRoot":"","sources":["../../src/services/auth.service.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,+CAAiC;AAEjC,MAAa,gBAAgB;IAC3B,mBAAmB,CAAC,UAAkB,EAAE,MAAc,EAAE,MAAc,EAAE,GAAW,EAAE,SAA8B,EAAE;QACnH,MAAM,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,EAAE,GAAG,IAAI,CAAC,CAAC,QAAQ,EAAE,CAAC;QAC3D,MAAM,KAAK,GAAG,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;QAErD,6BAA6B;QAC7B,MAAM,YAAY,GAAG,GAAG,MAAM,IAAI,GAAG,IAAI,SAAS,IAAI,KAAK,EAAE,CAAC;QAE9D,+BAA+B;QAC/B,MAAM,YAAY,GAAG,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC;aACrC,IAAI,EAAE;aACN,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,IAAI,MAAM,CAAC,GAAG,CAAC,EAAE,CAAC;aACnC,IAAI,CAAC,GAAG,CAAC,CAAC;QAEb,MAAM,OAAO,GAAG,YAAY;YAC1B,CAAC,CAAC,GAAG,YAAY,IAAI,YAAY,EAAE;YACnC,CAAC,CAAC,YAAY,CAAC;QAEjB,gBAAgB;QAChB,MAAM,IAAI,GAAG,MAAM;aAChB,UAAU,CAAC,QAAQ,EAAE,MAAM,CAAC;aAC5B,MAAM,CAAC,OAAO,CAAC;aACf,MAAM,CAAC,KAAK,CAAC,CAAC;QAEjB,OAAO;YACL,eAAe,EAAE,GAAG,UAAU,IAAI,IAAI,EAAE;YACxC,mBAAmB,EAAE,SAAS;YAC9B,eAAe,EAAE,KAAK;SACvB,CAAC;IACJ,CAAC;CACF;AA9BD,4CA8BC","sourcesContent":["import * as crypto from 'crypto';\r\n\r\nexport class KhipuAuthService {\r\n  generateAuthHeaders(receiverId: string, secret: string, method: string, url: string, params: Record<string, any> = {}) {\r\n    const timestamp = Math.floor(Date.now() / 1000).toString();\r\n    const nonce = crypto.randomBytes(16).toString('hex');\r\n    \r\n    // Create concatenated string\r\n    const concatenated = `${method}&${url}&${timestamp}&${nonce}`;\r\n    \r\n    // Add parameters if they exist\r\n    const sortedParams = Object.keys(params)\r\n      .sort()\r\n      .map(key => `${key}=${params[key]}`)\r\n      .join('&');\r\n    \r\n    const message = sortedParams \r\n      ? `${concatenated}&${sortedParams}`\r\n      : concatenated;\r\n\r\n    // Generate HMAC\r\n    const hmac = crypto\r\n      .createHmac('sha256', secret)\r\n      .update(message)\r\n      .digest('hex');\r\n\r\n    return {\r\n      'Authorization': `${receiverId}:${hmac}`,\r\n      'X-Khipu-Timestamp': timestamp,\r\n      'X-Khipu-Nonce': nonce\r\n    };\r\n  }\r\n}"]}